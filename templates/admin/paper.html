<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>edit</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/filepond/dist/filepond.css">

    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap-theme.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static',filename='editormd/css/editormd.css') }}"/>
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}">
    <script src="{{ url_for('static',filename='editormd/editormd.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static',filename='txtfile.js') }}"></script>

</head>
<body>
<div class="container">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div class="page-header">
                <h1>
                    MAGUS <small>åå°ç®¡ç†</small>
                </h1>
            </div>
            <ul class="breadcrumb">
                <li><a href="{{ url_for('.pic') }}">è½®æ’­å›¾ç¼–è¾‘</a></li>
                <li><a href="{{ url_for('.member') }}">æˆå‘˜ç¼–è¾‘</a></li>
                <li><a href="{{ url_for('.news') }}">å¿«è®¯ç¼–è¾‘</a></li>
                <li><a href="{{ url_for('.paper') }}">è®ºæ–‡ç¼–è¾‘</a></li>
                <li><a href="{{ url_for('.patent') }}">ä¸“åˆ©ç¼–è¾‘</a></li>
                <li><a href="{{ url_for('.competition') }}">ç«èµ›ç¼–è¾‘</a></li>
                <li><a href="{{ url_for('.partner') }}">åˆä½œæ–¹</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="container">
    <form id="form_zh" method="post">
        <div class="container">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <h3 class="text-center">
                        ä¸­æ–‡è®ºæ–‡é¡µé¢ç¼–è¾‘
                    </h3>
                </div>
            </div>
        </div>
        <div id="zh-editormd">
            <textarea name="paper_zh" id="paper_zh">{{ paper_zh }}</textarea>
        </div>
        <label><input type="checkbox"/>ç¡®è®¤ä¿®æ”¹</label>
        <input form="content" type="submit" name="submit" value="æäº¤ä¿®æ”¹" ,
               onclick=submit_txt("form_zh","/admin/pub/paper_zh/")>
        <input type="reset" name="reset" value="é‡ç½®">
    </form>
</div>


<div class="container">
    <form method="post" id="form_en">
        <div class="container">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <h3 class="text-center">
                        è‹±æ–‡è®ºæ–‡é¡µé¢ç¼–è¾‘
                    </h3>
                </div>
            </div>
        </div>
        <div id="en-editormd">
            <textarea name="paper_en" id="paper_en">{{ paper_en }}</textarea>
        </div>
        <label><input type="checkbox"/>ç¡®è®¤ä¿®æ”¹</label>
        <input form="content" type="submit" name="submit" value="æäº¤ä¿®æ”¹"
               onclick=submit_txt("form_en","/admin/pub/paper_en/")>
        <input type="reset" name="reset" value="é‡ç½®">
    </form>
    <script type="text/javascript">
        var testEditor;
        $(function () {
            testEditor = editormd("en-editormd", {
                width: "100%",
                height: 640,
                syncScrolling: "single",
                path: "{{ url_for('static',filename='editormd/lib/') }}",
                // ä¸Šä¼ å›¾ç‰‡
                imageUpload: true,
                imageFormats: ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
                // ä¸Šä¼ å›¾ç‰‡æ—¶æŒ‡å®šè°ƒç”¨åå°çš„è§†å›¾å‡½æ•°
                // homepageæ˜¯è“å›¾ uploadsæ˜¯è®¿é—®url
                imageUploadURL: "{{ url_for('admin.upload_file') }}",
            });
        });
    </script>
    <script type="text/javascript">
        var testEditor;

        $(function () {
            testEditor = editormd("zh-editormd", {
                width: "100%",
                height: 640,
                syncScrolling: "single",
                path: "{{ url_for('static',filename='editormd/lib/') }}",
                // ä¸Šä¼ å›¾ç‰‡
                imageUpload: true,
                imageFormats: ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
                // ä¸Šä¼ å›¾ç‰‡æ—¶æŒ‡å®šè°ƒç”¨åå°çš„è§†å›¾å‡½æ•°
                // homepageæ˜¯è“å›¾ uploadsæ˜¯è®¿é—®url
                imageUploadURL: "{{ url_for('admin.upload_file') }}",

            });
        });
    </script>
</div>

<div class="container">
    <div class="content">
        <input type="file" name="file" id="file" style="visibility: hidden"/>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
<script src="https://unpkg.com/filepond/dist/filepond.min.js"></script>
<script src="https://unpkg.com/jquery-filepond/filepond.jquery.js"></script>
<script src="https://unpkg.com/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.js"></script>
<script src="https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js"></script>

<script>
    $(function () {
        // file
        const fadeDuration = 500;
        localStorage.setItem('uniqueFileIds', JSON.stringify([]));
        let fileIds = [];
        $.fn.filepond.registerPlugin(FilePondPluginFileValidateSize, FilePondPluginFileValidateType);
        $('#file').filepond({
            maxFiles: 5,
            dropValidation: true,
            allowDrag: true,
            allowMultiple: true,
            labelIdle: 'æŠŠæ–‡ä»¶æ‹–åˆ°è¿™å„¿ æˆ– æµè§ˆæœ¬åœ°æ–‡ä»¶',
            labelInvalidField: 'åŒ…å«äº†æ— æ•ˆæ–‡ä»¶',
            labelFileWaitingForSize: 'æ­£åœ¨è·å–æ–‡ä»¶å¤§å°',
            labelFileSizeNotAvailable: 'è·å–ä¸åˆ°orz',
            labelFileLoading: 'æ­£åœ¨åŠ è½½æ–‡ä»¶',
            labelFileLoadError: 'åŠ è½½é”™è¯¯ï¼',
            labelFileProcessing: 'æ–‡ä»¶ä¸Šä¼ ä¸­',
            labelFileProcessingComplete: 'ä¸Šä¼ å®Œæˆ',
            labelFileProcessingAborted: 'å–æ¶ˆä¸Šä¼ å•¦',
            labelFileProcessingError: 'ä¸Šä¼ æ—¶é‡åˆ°é”™è¯¯',
            labelFileProcessingRevertError: 'æ’¤é”€æ—¶é‡åˆ°é”™è¯¯',
            labelFileRemoveError: 'åˆ é™¤æ—¶é‡åˆ°é”™è¯¯',
            labelTapToCancel: 'å–æ¶ˆ ğŸ‘‰',
            labelTapToRetry: 'é‡è¯• ğŸ‘‰',
            labelTapToUndo: 'æ’¤é”€ ğŸ‘‰',
            labelButtonRemoveItem: '',
            labelButtonAbortItemLoad: '',
            labelButtonRetryItemLoad: '',
            labelButtonAbortItemProcessing: '',
            labelButtonUndoItemProcessing: '',
            labelButtonRetryItemProcessing: '',
            labelButtonProcessItem: '',
            maxFileSize: '24MB',
            maxTotalFileSize: '50MB',
            labelMaxFileSizeExceeded: 'è¿™ä¸ªæ–‡ä»¶å¤ªå¤§å•¦ï¼',
            labelMaxFileSize: 'æœ€å¤šæœ€å¤šåªèƒ½ {filesize} å“¦',
            labelMaxTotalFileSizeExceeded: 'æ–‡ä»¶åŠ èµ·æ¥å¤ªå¤§äº†',
            labelMaxTotalFileSize: 'æœ€å¤šåªèƒ½ {filesize} å•¦',
            server: {
                url: '{{ host }}',
                process: {
                    url: "{{ url_for('handle_files') }}",
                    method: 'POST',
                    onload: (response) => {
                        response = JSON.parse(response);
                        if (response.code === 0) {
                            let fileId = response.data;
                            fileIds.push(fileId);
                            return fileId;
                        } else if (response.code === -1) {
                            $('#file-type-warning').fadeIn(fadeDuration);
                            setTimeout(() => {
                                $('#file-type-warning').fadeOut(fadeDuration);
                            }, 3000);
                            console.log(response.msg);
                        } else {
                            console.log(response.msg);
                        }
                    },
                    onerror: (response) => {
                        console.log(response);
                    }
                },
                revert: {
                    url: '{{ url_for('handle_files') }}',
                    onload: (response) => {
                        response = JSON.parse(response);
                        let fileId = response.data;
                        let index = fileIds.indexOf(fileId);
                        if (index > -1) {
                            fileIds.splice(index, 1)
                        }
                        return fileId;
                    }
                },
                fetch: null,
                load: null,
                restore: null
            }
        });
    });
</script>
</body>
</html>
